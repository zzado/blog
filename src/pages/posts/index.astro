---
import Layout from '../../layouts/Layout.astro';
import { getCollection } from 'astro:content';

const { BASE_URL } = import.meta.env;
const homeUrl = BASE_URL.endsWith('/') ? BASE_URL : BASE_URL + '/';

const posts = (await getCollection('blog')).sort(
	(a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf()
);
---

<Layout>
	<div class="max-w-4xl mx-auto px-4 py-8 sm:px-6 lg:px-8">
		<h1 class="text-3xl font-bold text-gray-900 dark:text-white mb-8">Blog Posts</h1>
		<div class="grid gap-8 md:grid-cols-2">
			{
				posts.map((post) => (
					<article class="bg-white dark:bg-stone-800 rounded-lg shadow-sm border border-stone-200 dark:border-stone-700 hover:shadow-md transition-shadow overflow-hidden">
						<a href={`${homeUrl}posts/${post.slug}`} class="block">
							{post.data.heroImage && (
								<img width={720} height={360} src={post.data.heroImage.startsWith('/') ? homeUrl + post.data.heroImage.substring(1) : post.data.heroImage} alt="" class="w-full h-48 object-cover" />
							)}
							<div class="p-6">
								<h2 class="text-xl font-semibold text-gray-900 dark:text-white mb-2 group-hover:text-blue-600 dark:group-hover:text-blue-400">
									{post.data.title}
								</h2>
								<p class="text-sm text-gray-500 dark:text-gray-400 mb-4">
                                    {post.data.pubDate.toLocaleDateString('ko-KR')}
								</p>
                                <p class="text-gray-600 dark:text-gray-300 line-clamp-3">
                                    {post.data.description}
                                </p>
							</div>
						</a>
					</article>
				))
			}
		</div>
	</div>
</Layout>
